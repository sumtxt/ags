<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Crosswalk Municipality or District Statistics — xwalk_ags • ags</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Crosswalk Municipality or District Statistics — xwalk_ags"><meta property="og:description" content="This function constructs time series of counts for Germany's municipalities
(Gemeinden) and districts (Kreise)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ags</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ags.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sumtxt/ags/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Crosswalk Municipality or District Statistics</h1>
    <small class="dont-index">Source: <a href="https://github.com/sumtxt/ags/blob/HEAD/R/xwalk_ags.R" class="external-link"><code>R/xwalk_ags.R</code></a></small>
    <div class="hidden name"><code>xwalk_ags.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function constructs time series of counts for Germany's municipalities
(Gemeinden) and districts (Kreise).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">xwalk_ags</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">ags</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">xwalk</span>,</span>
<span>  variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weight <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fuzzy_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A data frame or a data frame extension (e.g. a tibble).</p></dd>


<dt>ags</dt>
<dd><p>Name of the character variable (quoted) with municipality
AGS (Gemeinden, 8 digits) or district AGS (Kreise, 5 digits).</p></dd>


<dt>time</dt>
<dd><p>Name of the variable (quoted) identifying the year
(YYYY format). Values will be coerced to integers.</p></dd>


<dt>xwalk</dt>
<dd><p>Name of the crosswalk. The following crosswalks are available:</p><ul><li><p><code>xd19</code>, <code>xd20</code> for district-level data
between 1990-2019/2020.</p></li>
<li><p><code>xm19</code>, <code>xm20</code> for municipality-level
data between 1990-2019/2020.</p></li>
</ul></dd>


<dt>variables</dt>
<dd><p>Either a vector of names (quoted) for
variables to interpolate or <code>NULL</code> to disable interpolation and
return the data matched with the <code>xwalk</code>.</p></dd>


<dt>strata</dt>
<dd><p>Vector of variable names (quoted) or <code>NULL</code>. See
details.</p></dd>


<dt>weight</dt>
<dd><p>Name of the interpolation weight or <code>NULL</code>.
The following are available:</p><ul><li><p><code>pop</code>: Population weights.</p></li>
<li><p><code>size</code>: Area weights.</p></li>
<li><p><code>emp</code>: Weights based on the number of employees (1998 onwards).</p></li>
</ul></dd>


<dt>fuzzy_time</dt>
<dd><p>If <code>FALSE</code> the crosswalk and the <code>data</code>
are matched exactly by <code>ags</code> and <code>time</code>. If <code>TRUE</code>
they are matched exactly by <code>ags</code> and as best as possible on
<code>time</code>. See details below.</p></dd>


<dt>verbose</dt>
<dd><p>If <code>TRUE</code> the function outputs information on
the number of matched and unmatched rows.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If interpolation is requested, the crosswalked and interpolated
data are returned. If interpolation is not requested, the <code>data</code> matched
with the crosswalk are returned. The following variables are added:</p><ul><li><p><code>row_id</code> row number of <code>data</code> before matching.</p></li>
<li><p><code>ags[*]</code> the crosswalked AGS.</p></li>
<li><p><code>year_xw</code> the matched year from the crosswalk.</p></li>
<li><p><code>[*]_conv</code> the interpolation weight.</p></li>
<li><p><code>diff</code> the absolute difference between <code>year_xw</code>
and <code>time</code>.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function facilitates the use of crosswalks constructed by
the BBSR for municipalities and districts in Germany (Milbert 2010).
The crosswalks map one year's set of district/municipality
identifiers to later year's identifiers and provide weights
to perform area or population weighted interpolation.</p>
<p>All data rows with <code>NA</code>s in either the <code>ags</code> or <code>time</code>
variable are excluded. The same applies to all rows with a value in
<code>ags</code> or <code>time</code> that never appears in the crosswalk.</p>
<p>Fuzzy matching uses the absolute difference between the year reported
in the data and a crosswalk year. If there is a tie, crosswalk years from
before the year reported in the data are preferred.</p>
<p>If area or population weighted interpolation is requested (i.e., when
<code>variables</code> are supplied), the combination of the variables set
in <code>ags</code>, <code>time</code> and <code>strata</code> need to uniquely
identify a row in <code>data</code>.</p>
<p>Caution: Data from <a href="https://www.regionalstatistik.de/" class="external-link">https://www.regionalstatistik.de/</a> <em>sometimes</em> includes
annual values for merged units (e.g., Städteregion Aachen, 05334)) and
for their former parts (Kreis Aachen, 05354 and Stadt Aachen, 05313).
When such data is crosswalked with <code>fuzzy_time=TRUE</code> and
interpolated, the final counts will be off by approximately factor 2.
The reason is that the final output is the sum of the interpolated counts
for the parts and the measured count of the merged unit.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Milbert, Antonia. 2010.
<a href="https://www.bbsr.bund.de/BBSR/DE/veroeffentlichungen/berichte-kompakt/2010/BK062010.html" class="external-link">
"Gebietsreformen–politische Entscheidungen und Folgen für die Statistik."</a>
BBSR-Berichte kompakt 6/2010. Bundesinsitut für Bau-, Stadt-und Raumfoschung.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">btw_sn</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">btw_sn_ags20</span> <span class="op">&lt;-</span> <span class="fu">xwalk_ags</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">btw_sn</span>,</span></span>
<span class="r-in"><span>    ags <span class="op">=</span> <span class="st">"district"</span>,</span></span>
<span class="r-in"><span>    time <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>    xwalk <span class="op">=</span> <span class="st">"xd20"</span>,</span></span>
<span class="r-in"><span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"voters"</span>, <span class="st">"valid"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    weight <span class="op">=</span> <span class="st">"pop"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of obs: 155 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Excluded obs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id/time NA    AGS unk   Year unk </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          0          0          0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched obs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> exact fuzzy </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   126    NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched obs: 29 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">btw_sn_ags20</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>internal error -3 in R_decompress1</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in get_extent(format_type_sum(type, NULL)):</span> lazy-load database '/opt/homebrew/lib/R/4.2/site-library/utf8/R/utf8.rdb' is corrupt</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://moritz-marbach.com/" class="external-link">Moritz Marbach</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

